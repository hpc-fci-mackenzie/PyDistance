language: cpp

compiler:
  - gcc

matrix:

  allow_failures:
    - os: osx
    - os: windows

  include:

    - os: linux
      env: REGISTER_WIDTH=auto

    - os: osx
      env: REGISTER_WIDTH=auto

    - os: windows
      env: REGISTER_WIDTH=auto
      install: choco install mingw --version 4.9.3 --force
      script: mingw32-make travis

    - os: linux
      env: REGISTER_WIDTH=128

    - os: osx
      env: REGISTER_WIDTH=128

    - os: windows
      env: REGISTER_WIDTH=128

    - os: linux
      env: REGISTER_WIDTH=256
      sudo: yes
      dist: trusty
      before_install:
        - sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
        - sudo apt-get update -qq
      install: 
        - sudo apt-get install -qq g++-7
        - sudo update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-7 90

script:
    - mkdir build 
    - cd build
    - cmake .. -DREGISTER_WIDTH=$REGISTER_WIDTH
    - make -j 2
